/* Generated by Freestyle Learning Group */

package freestyleLearning.setupCore.installAnywhere;

import java.io.File;

import com.zerog.ia.api.pub.CustomCodeRule;

public class FSLCheckInstallationRule extends CustomCodeRule {
    private final int TIMES_TO_CHECK = 2;
    private int timesChecked = 0;
    private boolean checkedBefore = false;

    /**
     * <p>This method is called at install-time when evaluating the rules set on a given installer action.</p>
     * @return <code>true</code> if the rule has evaluated to true (i.e., positive case), <code>false</code> otherwise.
     */
    public boolean evaluateRule() {
        /**
         * Check if installation directory NOT already exists (false).
         * Must be evaluated only once for every presented install sets following this rule.
         * Later checks must result in "directory exists" (true).
         * (IA is performing checks at every single succeding installation step!)
         */
        if (!checkedBefore) {
            checkedBefore = (++timesChecked > TIMES_TO_CHECK);
            String userInstallDir = ruleProxy.substitute("$USER_INSTALL_DIR$");
            File installationFolder = new File(userInstallDir);
            if (installationFolder.exists() && installationFolder.isDirectory())
                return false; // do not show install set
        }
        // DO perform any succeding installation steps
        return true;
    }
}
