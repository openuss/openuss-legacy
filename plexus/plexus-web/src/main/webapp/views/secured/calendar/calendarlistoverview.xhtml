<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:plexus="http://www.openuss.org/plexus/jsf"
	xmlns:o="http://www.openuss.org/jsfcontrols"
	xmlns:t="http://myfaces.apache.org/tomahawk"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:s="http://www.openuss.org/jsf-security"
	xmlns:news="http://www.openuss.org/news/jsf"
	xmlns:fck="http://www.fck-faces.org/fck-faces">

	<h:form id="openuss4us_calendaroverview" enctype="multipart/form-data">
		<div id="appointmentbox">
		<plexus:dataTable id="appointmentTable"
			value="views$secured$calendar$calendarlist.appointmentData"
			var="appointment" rows="20"
			label="#{msg.openuss4us_calendar_appointments}">
			
			<t:column>
			<plexus:commandSortHeader columnName="serialAppointmentType"> #{msg['openuss4us_calendar_appointment_type_table']}</plexus:commandSortHeader>
			<h:commandLink value="" action="#{views$secured$calendar$calendarlist.appointmentDetails}"
			rendered="#{appointment.calendarType eq 'USER'}"
			title="#{msg.openuss4us_calendar_appointment_type_private}">
			<img src="#{theme.imagesPath}/icons/date_private.png"/>
			</h:commandLink>
			<h:commandLink value="" action="#{views$secured$calendar$calendarlist.appointmentDetails}"
			rendered="#{appointment.calendarType eq 'GROUP'}"
			title="#{msg.openuss4us_calendar_appointment_type_group}">
			<img src="#{theme.imagesPath}/icons/date_group.png"/>
			</h:commandLink>
			<h:commandLink value="" action="#{views$secured$calendar$calendarlist.appointmentDetails}"
			rendered="#{appointment.calendarType eq 'COURSE'}"
			title="#{msg.openuss4us_calendar_appointment_type_course}">
			<img src="#{theme.imagesPath}/icons/date_course.png"/>
			</h:commandLink>
			</t:column>
			
			<t:column styleClass="col_max_left">
				<plexus:commandSortHeader columnName="starttime" arrow="down">#{msg.openuss4us_calendar_appointment_date}</plexus:commandSortHeader>
				<h:outputText value="#{appointment.starttime}">
					<f:convertDateTime pattern="E, dd.MM.yyyy" timeZone="#{user.timezone}" />
				</h:outputText>
			</t:column>
			<t:column styleClass="col_max_left">
				<plexus:commandSortHeader columnName="starttime">#{msg.openuss4us_calendar_time}</plexus:commandSortHeader>
				<h:outputText value="#{appointment.starttime}">
					<f:convertDateTime pattern="H:mm" timeZone="#{user.timezone}" />
				</h:outputText>
				<h:outputText value=" - " />
				<h:outputText value="#{appointment.endtime}">
					<f:convertDateTime pattern="H:mm" timeZone="#{user.timezone}" />
				</h:outputText>
			</t:column>
			
			<t:column styleClass="col_max_left">
				<plexus:commandSortHeader columnName="subject">#{msg.openuss4us_calendar_subject}</plexus:commandSortHeader>
				<h:commandLink value="#{appointment.subject}"
					action="#{views$secured$calendar$calendarlist.appointmentDetails}"
					styleClass="appointmentheader"/>
				<br />
				<h:commandLink value="#{appointment.description}"
					action="#{views$secured$calendar$calendarlist.appointmentDetails}"
					styleClass="appointmentdetails"/>
				<o:microformatCalendar appointmentInfo="#{appointment}"/>
			</t:column>
			
			<t:column styleClass="col_max_left">
				<plexus:commandSortHeader columnName="location">#{msg.openuss4us_calendar_location}</plexus:commandSortHeader>
				<h:outputText value="#{appointment.location}" />
			</t:column>

		</plexus:dataTable>
		</div>
		<o:block>
			<s:acl domainObject="#{calendarInfo}" hasPermission="#{ACL.UPDATE}">
				<h:commandButton
					value="#{msg.openuss4us_calendar_button_create_single_appointment}"
					title="#{msg.openuss4us_calendar_button_create_single_appointment}"
					action="calendar_create_single_appointment" styleClass="button_big" />
				<h:commandButton
					value="#{msg.openuss4us_calendar_button_create_serial_appointment}"
					title="#{msg.openuss4us_calendar_button_create_serial_appointment}"
					action="calendar_create_serial_appointment" styleClass="button_big" />
			</s:acl>

		</o:block>
	</h:form>
</ui:composition>