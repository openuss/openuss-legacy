<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:news="http://www.openuss.org/news/jsf"
      xmlns:t="http://myfaces.apache.org/tomahawk"
      xmlns:c="http://java.sun.com/jstl/core"
      xmlns:o="http://www.openuss.org/jsfcontrols">
      
	<o:input entity="instituteInfo" property="name" maxlength="250" required="true"/>
	<o:input entity="instituteInfo" property="shortName" maxlength="250" required="true"/>
	<o:input entity="instituteInfo" property="shortcut" maxlength="30" required="true"/>
	
	<t:saveState id="institute_university_id" value="#{views$secured$lecture$instituteoptions.universityId}" />
	<t:saveState id="institute_department_id" value="#{views$secured$lecture$instituteoptions.departmentId}" />
 
 	<h:outputLabel value="#{msg.institute_preferences_university}" 
 				   for="universitySelect" 
 				   styleClass="field_label" 
 				   rendered="#{!empty instituteInfo.id}"/>
 				   
	<h:selectOneListbox 
			id="institute_preferences_university" 
			size="1" 
			styleClass="pulldown" 
			value="#{views$secured$lecture$instituteoptions.universityId}"
			valueChangeListener="#{views$secured$lecture$instituteoptions.processUniversitySelectChanged}" 
			onchange="this.form.submit();"
			immediate="true">
 			<f:selectItems value="#{views$secured$lecture$instituteoptions.allUniversities}"/>
 			<f:validator validatorId="universityDepartmentSelectValidator"/>
	</h:selectOneListbox>

	<h:outputLabel value="#{msg.department_selection}"  	
					for="departmenSelection" 
					styleClass="field_label"
					rendered="#{!empty instituteInfo.id}"/>
	<h:selectOneListbox
    	    id="departmentSelection" 
			size="1" 
			value="#{views$secured$lecture$instituteoptions.departmentId}"
			layout="pageDirection" 
			styleClass="pulldown"
			rendered="#{!empty instituteInfo.id}">
			<f:selectItems value="#{views$secured$lecture$instituteoptions.allDepartments}"/>
			<f:validator validatorId="instituteDepartmentSelectValidator"/>
	</h:selectOneListbox>
	
	<c:if test="#{!empty views$secured$lecture$instituteoptions.pendingApplicationInfo}">
		<h:outputText value="#{views$secured$lecture$instituteoptions.pendingApplicationInfo}" styleClass="content_font_normal" escape="true"/>
		<br></br>
		<h:outputText value="#{views$secured$lecture$instituteoptions.pendingApplicationResponsibleInfo}" styleClass="content_font_normal" escape="true"/>
	</c:if>
				
	<h:outputLabel value="#{msg.instituteinfo_description}" for="descriptionEditor" styleClass="field_label"/>
	<h:inputTextarea styleClass="pulldown" value="#{instituteInfo.description}" id="descriptionTextField" />
	<o:input entity="instituteInfo" property="ownerName" maxlength="100" required="true"/>
	<o:input entity="instituteInfo" property="email" maxlength="100" required="true">
		<t:validateEmail/>
	</o:input>
	<o:input entity="instituteInfo" property="address" maxlength="100"/>
	<o:input entity="instituteInfo" property="postcode" maxlength="50"/>
	<o:input entity="instituteInfo" property="city" maxlength="50"/>
	<o:input entity="instituteInfo" property="country" maxlength="50"/>
	<o:input entity="instituteInfo" property="telephone" maxlength="50"/>
	<o:input entity="instituteInfo" property="telefax" maxlength="50"/>
	<o:input entity="instituteInfo" property="website" maxlength="200"/>
	
	<h:outputLabel value="#{msg.institute_locale}" for="languageSelect" styleClass="field_label"/>
	<h:selectOneListbox id="languageSelect" size="1" styleClass="pulldown" value="#{instituteInfo.locale}">
	    <f:selectItems value="#{visit.supportedLocaleItems}"/>
	</h:selectOneListbox>
	
	<h:outputLabel value="#{msg.institute_theme}" for="themeSelect" styleClass="field_label"/>
	<h:selectOneListbox id="themeSelect" size="1" value="#{instituteInfo.theme}" styleClass="pulldown" >
	    <f:selectItems value="#{applicationScope.themeManager.selectableThemes}"/>
	</h:selectOneListbox>
	
	<h:panelGroup>
		  	<h:outputLabel value="#{msg.instituteinfo_logo}" for="image" styleClass="field_label" />
		  	<t:inputFileUpload id="image" storage="file" accept="image/*" immediate="true" styleClass="uploadField" >
  				<f:valueChangeListener type="org.openuss.web.upload.UploadListener" />
  			</t:inputFileUpload>
		  	<h:message for="image" styleClass="fieldError" showDetail="true" showSummary="false"/>
	</h:panelGroup>
	<t:htmlTag value="br" />
	<h:panelGroup styleClass="field_label">
		<c:if test="#{not empty instituteInfo.imageId}">
			<h:graphicImage styleClass="logo_preview"
				rendered="${not empty instituteInfo.imageId}"
				value="/files?fileid=#{instituteInfo.imageId}"
				alt="#{msg.logo} #{instituteInfo.name}"
				title="#{msg.logo} #{instituteInfo.name}"/> 
	  		<h:commandLink 
	  			actionListener="#{views$secured$lecture$instituteoptions.removeImage}" 
	  			immediate="true" 
	  			title="#{msg.command_remove_logo}">
	  			<h:graphicImage value="/images/icons/remove.gif" alt="delete"/>
	  		</h:commandLink>
		</c:if>
				
		<c:if test="#{empty instituteInfo.imageId}">
			<h:graphicImage 
				styleClass="userphoto" 
				value="/images/icons/no_pic.gif" 
				alt="#{msg.organisation_no_image}" 
				title="#{msg.organisation_no_image}"/>
		</c:if>
	</h:panelGroup>
	
</ui:composition>