<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:o="http://www.openuss.org/jsfcontrols"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:t="http://myfaces.apache.org/tomahawk"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:fck="http://www.fck-faces.org/fck-faces"
	xmlns:s="http://www.openuss.org/jsf-security">	
				<!-- personal information -->
					<br />
					<h:outputText value="#{msg.profile_personal_header}" styleClass="header_font_normal"/> <br />
					<o:input entity="user" property="birthday" maxlength="16" required="false" type="date"/>
					<o:input entity="user" property="searching" maxlength="500" required="false"/>
					<o:input entity="user" property="providing" maxlength="500" required="false"/>
					<o:input entity="user" property="interests" maxlength="500" required="false"/>
					<!-- user portrait -->
						<br />
					  	<h:outputText value="#{msg.user_profile_portrait}" styleClass="header_font_normal"/>
					  	<div class="content_iframe">
							<fck:editor value="#{user.portrait}" id="portraitEditor" toolbarSet="Portrait" width="100%"  height="200px">
								<f:converter converterId="xssFilter"/>
							</fck:editor>
						</div>
					

				<br />
				<s:authorize ifAllGranted="ROLE_USER">
					<!-- photo -->
						<br />
						<h:outputText value="#{msg.profile_personal_header}" styleClass="header_font_normal" /><br />					

						<h:outputLabel id="avatarSelectLabel" value="${msg.user_profile_image}" for="avatarSelect" styleClass="fieldLabel"/>
						<h:panelGrid columns="2">
							<h:panelGroup>
								
								<c:if test="#{not empty user.imageId}">
									<h:graphicImage styleClass="userphoto"
										renderer="${not empty user.imageId}"
										value="/files?fileid=#{user.imageId}"
										alt="#{user.firstName} #{user.lastName}"
										title="#{user.firstName} #{user.lastName}"/> 
									&#160;
							  		<h:commandLink 
							  			actionListener="#{views$secured$user$profile.removeImage}" 
							  			immediate="true" 
							  			title="#{msg.user_profile_command_remove_image}">
							  			<h:graphicImage value="/images/icons/remove.gif" alt="delete"/>
							  		</h:commandLink>
								</c:if>
										
								<c:if test="#{empty user.imageId}">
									<h:graphicImage 
										styleClass="userphoto" 
										value="/images/icons/no_pic.gif" 
										alt="#{msg.user_profile_no_image}" 
										title="#{msg.user_profile_no_image}"/>
								</c:if>
							</h:panelGroup>
					
							<h:panelGroup>
								<h:outputLabel value="#{msg.user_profile_image}" for="image"/>
								<br/>
							  	<t:inputFileUpload id="image" storage="file" accept="image/*" immediate="true" styleClass="uploadField" >
					  				<f:valueChangeListener type="org.openuss.web.upload.UploadListener" />
					  			</t:inputFileUpload>
							  	<h:message for="image" styleClass="fieldError" showDetail="true" showSummary="false"/>
							</h:panelGroup>
						</h:panelGrid>
				</s:authorize>

</ui:composition>