<!-- ================================================================= -->
<!-- Script file for starting needed servers               	           -->
<!-- Author Ingo Dueppe 		                                           -->
<!-- ================================================================= -->
<project name="openuss :: servers" basedir="." default="tomcat.debug" >

	<!-- =================================================================== -->
	<!-- Global properties                    			           			 -->
	<!-- =================================================================== -->
	<property name="ejosa.home" value="./../" />
	<property file="tomcat.${user.name}.properties" />
	<property file="tomcat.properties" />

	<property name="tomcat.home" value="${ejosa.home}/servers/tomcat" />
	<property name="tomcat.base" value="${tomcat.home}"/>
	<property name="tomcat.logging.file" value="${tomcat.base}/conf/logging.properties"/>

	<path id="catalina.path">
		<fileset dir="${tomcat.home}/bin">
			<include name="*.jar" />
		</fileset>
		<fileset dir="${tomcat.home}/common">
			<include name="**/*.jar" />
		</fileset>
		<fileset dir="${tomcat.home}/server/lib">
			<include name="*.jar" />
		</fileset>
	</path>
	
	<!-- =================================================================== -->
	<!-- Targets                 			           			 			 -->
	<!-- =================================================================== -->

	<target name="init">
	</target>

	<target name="tomcat.start" depends="init" description="start tomcat">
		<java jar="${tomcat.home}/bin/bootstrap.jar" fork="true">
			<sysproperty key="catalina.home" value="${tomcat.home}"/>
			<sysproperty key="catalina.base" value="${tomcat.base}"/>
			<arg line="start" />
		</java>
	</target>

	<target name="tomcat.stop" description="stop tomcat">
		<java jar="${tomcat.home}/bin/bootstrap.jar" fork="true">
			<sysproperty key="catalina.home" value="${tomcat.home}"/>
			<sysproperty key="catalina.base" value="${tomcat.base}"/>
			<arg line="stop" />
		</java>
	</target>

	<target name="tomcat.debug" depends="init" description="stop">
		<java jar="${tomcat.home}/bin/bootstrap.jar" classpathref="catalina.path" fork="true">
			<sysproperty key="catalina.home" value="${tomcat.home}"/>
			<sysproperty key="catalina.base" value="${tomcat.base}"/> 
			<jvmarg line="-Xdebug" />
			<jvmarg line="-Xrunjdwp:transport=dt_socket,address=8787,server=y,suspend=n" />
		</java>
	</target>

	<target name="jes-mail.start" depends="init" description="start mail server">
		<java classname="com.ericdaugherty.mail.server.Mail" fork="true">
			<arg line="${basedir}/jes-mail"/>
			<classpath>
				<fileset dir="${basedir}/jes-mail/lib">
					<include name="*.jar"/>
				</fileset>
			</classpath>
		</java>
	</target>

</project>
